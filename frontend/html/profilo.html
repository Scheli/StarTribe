<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Profilo Utente</title>
  <link rel="stylesheet" href="../style/profilo.css" />
  <link rel="stylesheet" href="../style/popup.css" />
  <link rel="stylesheet" href="../style/post-cards.css" />
  <link rel="stylesheet" href="../style/decorations.css" />
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar">
    <div class="username" id="navUsername"></div>
  </nav>

  <!-- Banner utente -->
  <div id="bannerProfilo" class="banner-profilo"></div>

  <div class="navbar">
    <button class="btn-navbar">
      <a href="/frontend/html/news.html" class="navLink">üì∞</a>
    </button>
    <button class="btn-navbar">
      <a href="/frontend/html/pubblicapost.html" class="navLink">‚ûï</a>
    </button>
    <button class="btn-navbar">
      <a href="/frontend/html/visualizzapost.html" class="navLink">üåç</a>
    </button>
    <button class="btn-navbar">
      <a href="/frontend/html/chat.html" class="navLink">üí¨</a>
    </button>
    <button class="btn-navbar">
      <a href="/frontend/html/space_road.html" class="navLink">üöÄ</a>
    </button>
  </div>

  <!-- Sezione principale: foto profilo + info utente -->
  <section class="sezione-utente">
    <div id="mediaProfilo" class="media-profilo"></div>

    <!-- Cornice/trofeo selezionato -->
    <div id="selectedBorderBox" style="display:none; text-align:center; margin-top:12px;">
      <img id="selectedBorderImg" alt="Cornice selezionata" style="max-width:160px; height:auto; border-radius:12px;" />
      <div style="font-size:.9rem; opacity:.8; margin-top:6px;">Cornice selezionata</div>
    </div>

    <div class="info-base">
      <h3>Informazioni Utente</h3>

      <!-- Contatori stile Instagram -->
      <div class="ig-stats" aria-label="Statistiche profilo">
        <div class="stat" id="openFollower" role="button" tabindex="0" aria-label="Apri follower">
          <div id="countFollower" class="num">0</div>
          <div class="lbl">Follower</div>
        </div>
        <div class="stat" id="openSeguiti" role="button" tabindex="0" aria-label="Apri seguiti">
          <div id="countSeguiti" class="num">0</div>
          <div class="lbl">Seguiti</div>
        </div>
      </div>

      <p><strong>Username:</strong> <span id="usernameDisplay"></span></p>
      <p><strong>Email:</strong> <span id="emailDisplay"></span></p>
      <p><strong>Data di nascita:</strong> <span id="birthdateDisplay"></span></p>
      <p><strong>Punti:</strong> <span id="puntiDisplay"></span></p>

      <div class="azioni-utente">
        <button id="btnModificaInfo">Modifica informazioni</button>
        <button id="btnModificaBanner">Modifica banner</button>
        <button id="btnModificaMedia">Modifica immagine profilo</button>
      </div>
    </div>
  </section>

  <!-- Sezione Post -->
  <section class="posts-section">
    <!-- Decorazioni lato sinistro -->
    <div class="side-decorations left">
      <img src="../assets/nebula1.jpg" alt="Decorative nebula">
      <img src="../assets/planet1.jpg" alt="Decorative planet">
    </div>

    <!-- Colonna centrale con i post -->
    <div class="post-container" id="postContainer">
      <h2 class="posts-title">Post di <span id="postUsername"></span></h2>
      <!-- I post verranno generati dinamicamente qui -->
    </div>

    <!-- Decorazioni lato destro -->
    <div class="side-decorations right">
      <img src="../assets/nebula2.jpg" alt="Decorative nebula">
      <img src="../assets/planet2.jpg" alt="Decorative planet">
    </div>
  </section>

  <!-- Sezione decorazioni -->
  <section class="bordi-wrapper">
    <h3>Decorazioni disponibili</h3>
    <div class="bordi-grid" id="bordiGrid">
      <div class="bordo-card">
        <img class="pfp-border" data-border="bronzo" src="/frontend/assets/border-bronzo.png" alt="Bronzo">
        <div class="bordo-label">Bronzo</div>
      </div>
      <div class="bordo-card">
        <img class="pfp-border" data-border="argento" src="/frontend/assets/border-argento.png" alt="Argento">
        <div class="bordo-label">Argento</div>
      </div>
      <div class="bordo-card">
        <img class="pfp-border" data-border="oro" src="/frontend/assets/border-oro.png" alt="Oro">
        <div class="bordo-label">Oro</div>
      </div>
      <div class="bordo-card">
        <img class="pfp-border" data-border="platino" src="/frontend/assets/border-platino.png" alt="Platino">
        <div class="bordo-label">Platino</div>
      </div>
      <div class="bordo-card">
        <img class="pfp-border" data-border="rubino" src="/frontend/assets/border-rubino.png" alt="Rubino">
        <div class="bordo-label">Rubino</div>
      </div>
      <div class="bordo-card">
        <img class="pfp-border" data-border="diamante" src="/frontend/assets/border-diamante.png" alt="Diamante">
        <div class="bordo-label">Diamante</div>
      </div>
      <div class="bordo-card">
        <img class="pfp-border" data-border="universo" src="/frontend/assets/border-universo.png" alt="Universo">
        <div class="bordo-label">Universo</div>
      </div>
    </div>
  </section>

  <!-- Bottone logout -->
  <div class="logout-section">
    <button id="logoutBtn">Logout</button>
  </div>

  <!-- Modifica informazioni -->
  <div id="modalInfo" class="modal-overlay">
    <div class="modal-content">
      <h3>Modifica informazioni utente</h3>
      <form id="modificaForm">
        <label>Username: </label>
        <input type="text" id="usernameInput">
        <label>Data di nascita:</label>
        <input type="date" id="birthdateInput">
        <button type="submit">Salva modifiche</button>
        <button type="button" class="btnChiudi" data-close="modalInfo">Chiudi</button>
      </form>
    </div>
  </div>

  <!-- Modifica banner -->
  <div id="modalBanner" class="modal-overlay">
    <div class="modal-content">
      <h3>Modifica banner</h3>
      <form id="bannerForm">
        <input type="file" name="file" accept="image/*" required />
        <button type="submit">Carica banner</button>
        <button type="button" class="btnChiudi" data-close="modalBanner">Chiudi</button>
      </form>
    </div>
  </div>

  <!-- Modifica immagine profilo -->
  <div id="modalMedia" class="modal-overlay">
    <div class="modal-content">
      <h3>Modifica immagine profilo</h3>
      <form id="uploadForm">
        <input type="file" name="file" accept="image/*,video/*" required />
        <button type="submit">Carica</button>
        <button type="button" class="btnChiudi" data-close="modalMedia">Chiudi</button>
      </form>
    </div>
  </div>

  <section class="post-wrapper">
  <h3>I tuoi post</h3>
  <div id="postContainer" class="post-container">
    <!-- I post verranno inseriti qui tramite JS -->
  </div>
</section>

  <!-- BOX CENTRALE: lista follower/seguiti -->
  <div id="modalUsers" class="modal-overlay">
    <div class="modal-content users">
      <h3 id="modalUsersTitle">Utenti</h3>
      <div id="userListContainer" class="userlist scroll"></div>
      <button type="button" class="btnChiudi" data-close="modalUsers">Chiudi</button>
    </div>
  </div>

  <script src="../js/utils/sanitize.js"></script>
  <script src="../js/profilo.js"></script>
  <script type="module" src="../js/areaprotetta.js"></script>

  <!-- Pulsante Album (in basso a destra) -->
  <a class="album-fab" href="album.html" aria-label="Apri album">
    <img src="../assets/album.png" alt="Album">
  </a>

  <script>
    // Logout
    document.getElementById('logoutBtn').addEventListener('click', () => {
      localStorage.removeItem('token');
      window.location.href = 'login.html';
    });

    // Apertura modali
    document.getElementById("btnModificaInfo").addEventListener("click", () => {
      document.getElementById("modalInfo").style.display = "flex";
    });
    document.getElementById("btnModificaBanner").addEventListener("click", () => {
      document.getElementById("modalBanner").style.display = "flex";
    });
    document.getElementById("btnModificaMedia").addEventListener("click", () => {
      document.getElementById("modalMedia").style.display = "flex";
    });

    // Chiusura modali generica
    document.querySelectorAll(".btnChiudi").forEach(btn => {
      btn.addEventListener("click", e => {
        const target = e.target.getAttribute("data-close");
        document.getElementById(target).style.display = "none";
      });
    });
  </script>
</body>
</html>
